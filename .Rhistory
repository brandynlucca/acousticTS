geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(shdf$Sp),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5) +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(shdf$Sp),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5)
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw()
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height")
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(shdf$Sp),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5)
unique(newsdf$Sp)
unique(shdf$Sp)
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(shdf$Sp[!is.na(shdf$Sp)]),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5) +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(shdf$Sp[!is.na(shdf$Sp)]),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5)
newsdf$n
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw()
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height")
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(newsdf$Sp),
lab=c("T. spinifera","T. raschii","T. inermis","E. pacifica")), size=4.5)
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(newsdf$Sp),
lab=c("E. pacifica","T. inermis","T. raschii","T. spinifera")), size=4.5)
newsdf <- shdf %>%
filter(!is.na(Sp)) %>%
group_by(Sp, Bin) %>%
summarise(x=mean(x), Mean=mean(y), SD=stats::sd(y), An=An[1], n=n())
for(i in unique(newsdf$An)){
idx <- which(newsdf$An == i)
if(newsdf$Sp[idx][1] == "T. spinifera" | newsdf$Sp[idx1][1] == "T. raschi"){
newsdf$Mean[idx] <- c(rev(newsdf$Mean[idx][1:17]),rev(newsdf$Mean[idx][18:length(idx)]))
newsdf$SD[idx] <- c(rev(newsdf$SD[idx][1:17]),rev(newsdf$SD[idx][18:length(idx)]))
}
}
# newsdf <- newsdf %>%
#   mutate(SD = ifelse(Sp %in% c("T. inermis","T. raschi"), SD * 2.3, SD))
# newsdf$x[newsdf$Sp == "T. spinifera"] <- rev(newsdf$x[newsdf$Sp == "T. spinifera"])
# newsdf$Mean[newsdf$Sp == "T. spinifera"] <- rev(newsdf$Mean[newsdf$Sp == "T. spinifera"])
# newsdf$SD[newsdf$Sp == "T. spinifera"] <- rev(newsdf$SD[newsdf$Sp == "T. spinifera"])
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(newsdf$Sp),
lab=c("E. pacifica","T. inermis","T. raschii","T. spinifera")), size=4.5)
newsdf$Sp
for(i in unique(newsdf$An)){
idx <- which(newsdf$An == i)
if(newsdf$Sp[idx][1] == "T. spinifera" | newsdf$Sp[idx1][1] == "T. raschi"){
newsdf$Mean[idx] <- c(rev(newsdf$Mean[idx][1:17]),rev(newsdf$Mean[idx][18:length(idx)]))
newsdf$SD[idx] <- c(rev(newsdf$SD[idx][1:17]),rev(newsdf$SD[idx][18:length(idx)]))
}
}
newsdf$Sp[idx][1] == "T. spinifera" | newsdf$Sp[idx1][1] == "T. raschi"
(newsdf$Sp[idx][1] == "T. spinifera" | newsdf$Sp[idx1][1] == "T. raschi")
for(i in unique(newsdf$An)){
idx <- which(newsdf$An == i)
if(newsdf$Sp[idx][1] == "T. spinifera" | newsdf$Sp[idx][1] == "T. raschi"){
newsdf$Mean[idx] <- c(rev(newsdf$Mean[idx][1:17]),rev(newsdf$Mean[idx][18:length(idx)]))
newsdf$SD[idx] <- c(rev(newsdf$SD[idx][1:17]),rev(newsdf$SD[idx][18:length(idx)]))
}
}
ggplot(data=newsdf,aes(x=x,y=Mean)) +
geom_point() +
geom_path() +
geom_errorbar(aes(x=x,ymin=Mean-SD, ymax=Mean+SD)) +
facet_wrap(~Sp) +
coord_cartesian(ylim=c(-0.295,0.295)) +
theme_bw() +
theme(panel.grid=element_blank(), strip.background=element_blank(), strip.text=element_blank(),
text=element_text(size=18), axis.text=element_text(size=16, color="black"), axis.text.x=element_text(angle=90)) +
labs(x="Normalized length",y="Normalized height") +
geom_text(aes(x=x,y=y,label=lab),
data=data.frame(x=rep(0.35,4),y=rep(0.275,4),Sp=unique(newsdf$Sp),
lab=c("E. pacifica","T. inermis","T. raschii","T. spinifera")), size=4.5)
require(installr)
updateR()
updateR()
require(acousticTS)
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,1),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,0.5)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
devtools::install_github("brandynlucca/acousticTS")
devtools::install_github("brandynlucca/acousticTS")
library("acousticTS", lib.loc="~/R/win-library/4.0")
detach("package:acousticTS", unload=TRUE)
devtools::install_github("brandynlucca/acousticTS")
require(acousticTS)
?SDWBA.sim
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,1),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,0.5)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FFSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, phase=pd, h=h, theta=theta, parallel=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, phase=pd, h=h, theta=theta, parallel=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
tar
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
an_idx
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T)
c
freq
curve
pc
pd
h
theta
parallel
SDWBA.sim(tar, c=c, frequency=120e3)
SDWBA.sim(tar, c=c, frequency=120e3, pc=c(1,2))
SDWBA.sim(tar, c=c, frequency=120e3, theta=c(-15,15))
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
?makeSOCKcluster
detach("package:acousticTS", unload=TRUE)
devtools::install_github("brandynlucca/acousticTS@test-branch")
require(acousticTS)
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
?makeSOCKcluster
?makeCluster
roxygen2::roxygenise()
setdir("C:/Users/Brandyn/Documents/GitHub/acousticTS")
getdir()
setwd("C:/Users/Brandyn/Documents/GitHub/acousticTS")
getwd()
roxygen2::roxygenise()
library("acousticTS", lib.loc="~/R/win-library/4.0")
detach("package:acousticTS", unload=TRUE)
devtools::install_github("brandynlucca/acousticTS")
require(acousticTS)
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,1),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,0.5)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
theta
tar@theta
SDWBA.sim <- function(shape=shape, x=shape@rpos[1,], y=shape@rpos[2,], z=shape@rpos[3,],
c=1500, frequency, phase=0.0, a=shape@a, h=shape@h, g=shape@g,
curve=shape@curve,
pc=shape@pc,
theta=shape@theta,
length=shape@L,
scale="log",
nrep=NULL, permute=F, aggregate=NULL, parallel=F, n.cores=NULL,
progress=T){
# if(theta[1] != shape@theta){
#   theta <- theta + pi/2
# }
theta <- theta + pi/2
if(!is.null(nrep)){
repseq <- seq(1,nrep,1)
}else{
repseq <- 1
}
if(permute == T){
simdf <- expand.grid(iteration=repseq, c=c, frequency=frequency, g=g, h=h, theta=theta, pc=pc, curve=curve, phase=phase, length=length, TS=NA)
}else{
lendf <- data.frame(param=c("h","g","curve","pc","theta","length","phase"),
len=c(length(h),length(g),length(curve),length(pc),length(theta),length(length),length(phase)))
val<- data.frame(x=seq(1,max(lendf$len),1))
simdf <- expand.grid(iteration=repseq, iterator=t(val), c=c, frequency=frequency)
simdf <- cbind(simdf, data.frame(g=rep(g,max(lendf$len)/lendf$len[2]*max(repseq)),
h=rep(h,max(lendf$len)/lendf$len[1]*max(repseq)),
theta=rep(theta,lendf$len[5]/max(lendf$len)*max(repseq)),
pc=rep(pc,max(lendf$len)/lendf$len[4]*max(repseq)),
curve=rep(curve,max(lendf$len)/lendf$len[3]*max(repseq)),
phase=rep(phase,max(lendf$len)/lendf$len[7]*max(repseq)),
length=rep(length,max(lendf$len)/lendf$len[6]*max(repseq)),
TS=NA))
simdf <- simdf[,-2]
}
if(progress == T){
bar <- txtProgressBar(min=1, max=nrow(simdf), style=3, title="Calculating TS values...")
progbar <- function(n) setTxtProgressBar(bar, n)
}
if(parallel==F){
for(i in 1:nrow(simdf)){
target_sim <- Shapely(shape,curve=simdf$curve[i],pc=simdf$pc[i],theta=simdf$theta[i],length=simdf$length[i])
simdf$TS[i] <- SDWBA(target_sim,c=simdf$c[i],frequency=simdf$frequency[i],phase=simdf$phase[i],g=simdf$g[i],h=simdf$h[i])
if(progress == T){
progbar(i)
}
}
}else if(parallel==T){
requireNamespace("foreach", quietly=T)
requireNamespace("doSNOW", quietly=T)
requireNamespace("snow", quietly=T)
if(!is.null(n.cores)){
n.cores <- n.cores
}else{
n.cores <- detectCores()
}
cl <- snow::makeCluster(n.cores)
registerDoSNOW(cl)
if(progress == T){
bar <- txtProgressBar(min=1, max=nrow(simdf), style=3)
opts <- list(progress=progbar)
}else{
opts <- list()
}
simdf$TS <- foreach(i=1:nrow(simdf), .combine=c, .packages="acousticTS", .options.snow=opts) %dopar% {
target_sim <- Shapely(shape,curve=simdf$curve[i],pc=simdf$pc[i],theta=simdf$theta[i],length=simdf$length[i])
SDWBA(target_sim,c=simdf$c[i],frequency=simdf$frequency[i],phase=simdf$phase[i],g=simdf$g[i],h=simdf$h[i])
}
stopCluster(cl)
if(progress == T){
close(bar)
}
}
if(!is.null(aggregate)){
dum <- data.frame(Stat=NA,TS=NA)
if("mean" %in% aggregate){
dum <- rbind(dum,data.frame(Stat="Mean", TS=10*log10(mean(10^(simdf$TS/10)))))
}
if("median" %in% aggregate){
dum <- rbind(dum,data.frame(Stat="Median", TS=median(simdf$TS)))
}
if("minimum" %in% aggregate){
dum <- rbind(dum,data.frame(Stat="Minimum", TS=min(simdf$TS)))
}
if("maximum" %in% aggregate){
dum <- rbind(dum,data.frame(Stat="Maximum", TS=max(simdf$TS)))
}
dum <- dum[-(is.na(dum$Stat)),]
return(dum)
}else{
if(scale %in% c("linear","both")){
simdf$sigmabs <- 10^(simdf$TS/10)
if(scale == "linear"){
simdf <- simdf[-(which(colnames(simdf) == "TS"))]
}
}
return(simdf)
}
}
theta
seq(-15,15,5)
degrad(seq(-15,15,5),"deg")
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,5),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,1)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
tmpdf
head(tmpdf)
rm(tmpdf)
require(acousticTS)
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,5),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,1)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
require(acousticTS)
require(acousticTS)
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,5),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,1)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
?detectCores
theta
round(theta,1)
round(theta,0)
0 %in% round(theta,0)
roxygen2::roxygenise()
rm(list=ls())
devtools::install_github("brandynlucca/acousticTS")
library("acousticTS", lib.loc="~/R/win-library/4.0")
detach("package:acousticTS", unload=TRUE)
devtools::install_github("brandynlucca/acousticTS")
require(acousticTS)
freq <- c(42,45,50,55,60,64,65,70,75,120,131,140,150,160,170,180,190,192,200,210)*1e3
theta <- degrad(seq(-15,15,5),"deg")
set.seed(1000)
h <- rnorm(250,mean=1.022338,sd=0.00856)
curve=T
pc <- seq(2,7,1)
pd = c(0,0.2,0.71)
c=1500
shapedir <- "G:/alaska.2017/dump3/"
shapefiles <- list.files(shapedir, pattern="Shape", full.names=T)
sdwbadf <- data.frame(Animal=c(),c=c(),frequency=c(),c=c(),h=c(),theta=c(),pc=c(),curve=c(),phase=c(),length=c(),TS=c())
for(i in 1:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
}
head(tmpdf)
unique(tmp.df$Animal)
unique(tmpdf$Animal)
nrow(tmpdf)
an_idx
?write.csv
sys.date
sys.date()
sys.date
Sys.Date()
paste("G:/alaska.2017/Model_runs/", tmpdf$Animal[1],"_",Sys.Date(),".csv",sep="")
degrad(1.308997, "rad")
write.csv(tmpdf, paste("G:/alaska.2017/Model_runs/AN", tmpdf$Animal[1],"_",Sys.Date(),".csv",sep=""))
head(shapefiles)
for(i in 2:length(shapefiles)){
st <- Sys.time()
tar <- FLSread(paste(shapefiles[i]))
an_idx <- strsplit(strsplit(strsplit(shapefiles[i],"/")[[1]][4],"_")[[1]],"[.]")[[2]][1]
tmpdf <- SDWBA.sim(tar, c=c, frequency=freq, curve=curve, pc=pc, phase=pd, h=h, theta=theta, parallel=T, permute=T)
ed <- Sys.time()
print(paste(shapefiles[i]," complete | File ",i," of ",length(shapefiles)," | Time elapsed: ",round(ed-st,3)," minutes!", sep=""))
tmpdf[,1] <- an_idx; colnames(tmpdf)[1] <- "Animal"
sdwbadf <- rbind(sdwbadf, tmpdf)
write.csv(tmpdf, paste("G:/alaska.2017/Model_runs/AN", tmpdf$Animal[1],"_",Sys.Date(),".csv",sep=""))
}
